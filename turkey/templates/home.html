{% extends "_base.html" %}

{% block content %}
  {% if current_user and current_user.name %}
    <a type="button" class="btn btn-default navbar-btn" href="{{ url_for('create_goal') }}">Create Goal</a>
    <a type="button" class="btn btn-default navbar-btn" href="{{ url_for('create_task') }}">Create Task</a>
    {%- for goal, children in tree['goals'].items() recursive %}
      <ul>
      <li>{{ goal[1] }}</li>
      {%- if children['open_tasks'] or children['completed_tasks'] %}
        <ol>
        {%- for task in children['tasks'] %}
          {%- if task['completed'] %}
            <a type="button" class="btn btn-info" disabled>{{ task['name'] }}</a><br />
          {%- else %}
            <a type="button" class="btn btn-warning" href="{{ url_for('complete_task', task_id=task['id']) }}">{{ task['name'] }}</a><br />
          {%- endif %}
        {%- endfor %}
        {%- for task in children['completed_tasks'] %}
        {%- endfor %}
        </ol>
      {%- endif %}
      <ul>{{ loop(children['goals'].items()) }}</ul>
      </ul>
    {%- endfor %}
  {% endif %}
{% endblock %}
